import{defineComponent as e,toRefs as t,computed as i,openBlock as o,createElementBlock as a,normalizeStyle as s}from"vue";import*as l from"monaco-editor";var d=e({name:"MonacoEditor",props:{diffEditor:{type:Boolean,default:!1},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:"100%"},original:String,value:String,language:{type:String,default:"javascript"},theme:{type:String,default:"vs"},options:{type:Object,default:()=>({})},validation:{type:Object,default:()=>({})}},emits:["editorWillMount","editorDidMount","change"],setup(e){const{width:o,height:a}=t(e);return{style:i((()=>({width:o.value.toString().includes("%")?o.value:`${o.value}px`,height:a.value.toString().includes("%")?a.value:`${a.value}px`,"text-align":"left"})))}},mounted(){this.initMonaco()},beforeUnmount(){l.editor.getModels().forEach((e=>e.dispose())),this.editor&&this.editor.dispose()},methods:{initMonaco(){this.$emit("editorWillMount",this.monaco);const{value:e,language:t,theme:i,options:o,original:a,validation:s}=this;if(this.diffEditor){const s=l.editor.createModel(a,t),d=l.editor.createModel(e,t);this.editor=l.editor.createDiffEditor(this.$el,{automaticLayout:!0,theme:i,fixedOverflowWidgets:!0,...o}),this.editor.setModel({original:s,modified:d})}else{const a=l.editor.createModel(e,t,l.Uri.parse("file:///file.yaml"));if(s.uri){const e=[{fileMatch:["file:///file.yaml"],schema:s.schema?JSON.parse(JSON.stringify({...s.schema,$schema:"http://json-schema.org/schema#"})):void 0,uri:s.uri}];this.$monacoYaml&&this.$monacoYaml.update({schemas:e}),l.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,enableSchemaRequest:!0,schemas:e,allowComments:!0})}this.editor=l.editor.create(this.$el,{automaticLayout:!0,model:a,theme:i,fixedOverflowWidgets:!0,...o})}const d=this._getEditor();d.onDidChangeModelContent((e=>{const t=d.getValue();this.value!==t&&this.$emit("change",t,e)})),this.$emit("editorDidMount",this.editor)},_setValue(e){let t=this._getEditor();if(t)return t.setValue(e)},_getValue(){let e=this._getEditor();return e?e.getValue():""},_getEditor(){return this.editor?this.diffEditor?this.editor.getModifiedEditor():this.editor:null},_setOriginal(){const{original:e}=this.editor.getModel();e.setValue(this.original)}},watch:{options:{deep:!0,handler(e){this.editor.updateOptions(e)}},value(){this.value!==this._getValue()&&this._setValue(this.value)},original(){this._setOriginal()},language(){if(this.editor)if(this.diffEditor){const{original:e,modified:t}=this.editor.getModel();l.editor.setModelLanguage(e,this.language),l.editor.setModelLanguage(t,this.language)}else l.editor.setModelLanguage(this.editor.getModel(),this.language)},theme(){l.editor.setTheme(this.theme)}}});d.render=function(e,t,i,l,d,r){return o(),a("div",{class:"monaco-editor-vue3",style:s(e.style)},null,4)};export{d as default};